# SIEM Tools

**Security information and event management**

***

[Splunk](https://www.notion.so/Splunk-6cd0d1b15d814bb9bc39ebf2e2ecad0b?pvs=21)

[Google Chronicle](https://www.notion.so/Google-Chronicle-266ab674f8bd4718b54686d69649e3f2?pvs=21)

***

* SIEM tools collect _**real-time information**_ for identifying potential breaches as they occur.
* Playbooks are used alongside SIEM tools, providing instructions for analysts on addressing flagged issues like unusual user behavior.
* _**Data sources**_ for SIEM include IDS, IPS, databases, firewalls, and applications, all aggregated into one centralized location.
* A large volume of raw data is collected by SIEM, but not all of it is relevant for security analysis.
* SIEM _**normalizes**_ data by cleaning up and removing non-essential attributes, ensuring consistency in log records.
* Normalized data is _**analyzed**_ against configured rules to detect security incidents, which are then categorized or reported as alerts for review.
* SIEM tools _**reduce the manual effort**_ of filtering through log data by providing _**alerts**_ for specific threats, risks, and vulnerabilities.
* SIEM tools offer _**dashboards**_ to visually organize data for analysis, with different types available depending on the tool.
* _**Hosting**_ options for SIEM include on-premise and cloud, chosen based on security team expertise and ease of setup and maintenance.

***

**SIEM Process for Data Collection**

1. **Collect and Process:** SIEM tools collect and process enormous amounts of data generated by devices and systems from all over an environment.
2. **Normalize:** SIEM tools normalize the data, so that it's formatted consistently and only relevant event information is included.
3. **Index:** SIEM tools index the data, so it can be accessed through search. This data structure is typically a hash table or a B-tree, which allows the tool to look up data based on a key, such as a timestamp or a field value.

***

*   **Log forwarders**

    There are many ways SIEM tools can ingest log data. For instance, you can manually upload data or use software to help collect data for log ingestion. Manually uploading data may be inefficient and time-consuming because networks can contain thousands of systems and devices. Hence, it's easier to use software that helps collect data.

    A common way that organizations collect log data is to use log forwarders. Log forwarders are software that automate the process of collecting and sending log data. Some operating systems have native log forwarders. If you are using an operating system that does not have a native log forwarder, you would need to install a third-party log forwarding software on a device. After installing it, you'd configure the software to specify which logs to forward and where to send them. For example, you can configure the logs to be sent to a SIEM tool. The SIEM tool would then process and normalize the data. This allows the data to be easily searched, explored, correlated, and analyzed.

    **Note**: Many SIEM tools utilize their own proprietary log forwarders. SIEM tools can also integrate with open-source log forwarders. Choosing the right log forwarder depends on many factors such as the specific requirements of your system or organization, compatibility with your existing infrastructure, and more.

    ***
*   **Searching and Querying Events in a SIEM Database**

    * Different SIEM tools use different search methods.
    * Splunk uses a query language called Search Processing Language (SPL).

    #### **Example of a Raw Log Search in Splunk Cloud**

    ```
    buttercupgames error OR fail*
    ```

    This search will return all events from the buttercupgames index that contain the term "error" or "fail". The asterisk at the end of the term "fail" is a wildcard, which means it will search for all possible endings that contain the term "fail".

    #### **Tips for Optimizing Search Performance**

    *   Use specific search terms.

        When searching for security events, it is important to use specific search terms. This will help to narrow down the search results and reduce the number of false positives.
    *   Use Boolean operators and wildcards.

        Boolean operators and wildcards can be used to expand your search results. For example, you can use the OR operator to search for events that contain multiple terms. You can also use the asterisk wildcard to search for all possible endings of a term.
    *   Use a time range picker.

        A time range picker can be used to specify the time period you want to search. This can help to reduce the amount of data that is searched and improve the performance of your search.
    *   Exclude certain events from the search results.

        You can exclude certain events from the search results by using the NOT operator. This can be useful for excluding events that are known to be false positives.

    ```c
    (error OR fail) AND time_range=-30d
    ```

    #### **Different SIEM tools use different search methods. Here are some examples:**

    * **Splunk:** Splunk uses a search language called Search Processing Language (SPL). SPL is a powerful language that allows you to search for events based on a variety of criteria, including event type, time range, and source.
    * **Elasticsearch:** Elasticsearch uses a query language called Lucene Query Syntax (LQS). LQS is a powerful language that allows you to search for events based on a variety of criteria, including event type, time range, and source.
    * **LogRhythm:** LogRhythm uses a search language called LogRhythm Query Language (LQL). LQL is a powerful language that allows you to search for events based on a variety of criteria, including event type, time range, and source.
    * **QRadar:** QRadar uses a search language called QRadar Query Language (QL). QL is a powerful language that allows you to search for events based on a variety of criteria, including event type, time range, and source.

    ***

***

\<aside> ðŸ“– _**Aggregation**_ is the process of gathering data from different sources and putting it in one centralized place.

\</aside>

\<aside> ðŸ“– _**Normalization**_ involves the transformation of raw log data to create consistent log records.

\</aside>

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/a85498c8-a854-4ca0-be5a-e5bb39c808e6/e299f8ac-640c-4f44-9ae5-465a3a27c330/Untitled.png)

***

```c
**April 3 11:01:21 server sshd[1088]: Failed password for user nuhara from 218.124.14.105 port 5023**
```

* host = **server**
* process = **sshd**
* source\_user = **nuhara**
* source ip = **218.124.14.10**
* source port = **5023**

***

### Three Common tools:

* Self-Hosted
* Cloud-Hosted
* Hybrid

***

### Protection

**VPN** is used to encrypt and protect data as it travels across the network. When you use a VPN, hackers might interfere with your traffic, but they won't be able to decode it to read it and read your private information. Another way to add a layer of protection against packet sniffing is to make sure that websites you have use HTTPS at the beginning of the domain address. Also to avoid using unprotected WiFi.

*   Network Interface Card (NIC)

    The deviceâ€™s Network Interface Card (NIC) is a piece of hardware that connects the device to a network. The NIC reads the data transmission, and if it contains the deviceâ€™s MAC address, it accepts the packet and sends it to the device to process the information based on the protocol. This occurs in all standard network operations. However, a NIC can be set to promiscuous mode, which means that it accepts all traffic on the network, even the packets that arenâ€™t addressed to the NICâ€™s device.

    ***

Malicious actors might use software like Wireshark to capture the data on a private network and store it for later use. They can then use the personal information to their own advantage. Alternatively, they might use the IP and MAC addresses of authorized users of the private network to perform IP spoofing.

***

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/a85498c8-a854-4ca0-be5a-e5bb39c808e6/f9e310b5-a851-4c7d-a06e-51b023e061e3/Untitled.png)

[Free Cybersecurity Services & Tools | CISA](https://www.cisa.gov/free-cybersecurity-services-and-tools)

***
